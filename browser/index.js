import{SvelteComponent as t,init as e,safe_not_equal as i,flush as s,append_styles as n,svg_element as r,text as o,attr as a,insert as c,append as l,set_data as h,detach as u,noop as d,destroy_each as p,component_subscribe as $,empty as f,create_component as g,mount_component as y,transition_in as m,transition_out as v,destroy_component as x,space as b,group_outros as w,check_outros as k,assign as O,set_svg_attributes as S,toggle_class as _,get_spread_update as M,compute_rest_props as A,exclude_internal_props as P,get_spread_object as E,binding_callbacks as j,create_slot as T,element as L,add_render_callback as D,add_resize_listener as C,update_slot_base as I,get_all_dirty_from_scope as K,get_slot_changes as V}from"https://unpkg.com/svelte@3/internal/index.mjs";import{range as z}from"https://unpkg.com/@aicacia/core@0/browser/index.js";import{getContext as Y,setContext as q,onMount as X}from"https://unpkg.com/svelte@3/index.mjs";import{vec2 as U,mat2d as H}from"https://unpkg.com/gl-matrix@3/esm";import{writable as B}from"https://unpkg.com/svelte@3/store/index.mjs";const R={};function N(){return Y(R)}const G={};function W(){return Y(G)}const F={};function J(){return Y(F)}const Q={};function Z(){return Y(Q)}function tt(t,e,i){return z(Math.floor(t/i)*i,Math.ceil(e/i)*i,i).iter().toArray()}function et(t){n(t,"svelte-133qdtd","g.svelte-133qdtd{paint-order:stroke;stroke-width:3px;stroke:var(--visual-math-line-color);stroke-opacity:0.75}")}function it(t,e,i){const s=t.slice();return s[9]=e[i],s}function st(t){let e,i,s,n,d=(t[0]?t[0](t[9]):t[9])+"";return{c(){e=r("text"),i=o(d),a(e,"x",s=t[1](t[9])),a(e,"y",n=5),a(e,"alignment-baseline","hanging"),a(e,"text-anchor","middle")},m(t,s){c(t,e,s),l(e,i)},p(t,n){5&n&&d!==(d=(t[0]?t[0](t[9]):t[9])+"")&&h(i,d),6&n&&s!==(s=t[1](t[9]))&&a(e,"x",s)},d(t){t&&u(e)}}}function nt(t){let e,i=t[2],s=[];for(let e=0;e<i.length;e+=1)s[e]=st(it(t,i,e));return{c(){e=r("g");for(let t=0;t<s.length;t+=1)s[t].c();a(e,"class","svelte-133qdtd")},m(t,i){c(t,e,i);for(let t=0;t<s.length;t+=1)s[t].m(e,null)},p(t,[n]){if(7&n){let r;for(i=t[2],r=0;r<i.length;r+=1){const o=it(t,i,r);s[r]?s[r].p(o,n):(s[r]=st(o),s[r].c(),s[r].m(e,null))}for(;r<s.length;r+=1)s[r].d(1);s.length=i.length}},i:d,o:d,d(t){t&&u(e),p(s,t)}}}function rt(t,e,i){let s,n,r,o,a,{separation:c}=e,{labelMaker:l}=e,h=N();$(t,h,(t=>i(8,a=t)));let u=Z();return $(t,u,(t=>i(7,o=t))),t.$$set=t=>{"separation"in t&&i(5,c=t.separation),"labelMaker"in t&&i(0,l=t.labelMaker)},t.$$.update=()=>{256&t.$$.dirty&&i(1,s=a.scaleX),128&t.$$.dirty&&i(6,n=o.xPanes),98&t.$$.dirty&&i(2,r=tt(n[0][0]-c,n[n.length-1][1]+c,c).filter((t=>Math.abs(s(t)-s(0))>1)))},[l,s,r,h,u,c,n,o,a]}class ot extends t{constructor(t){super(),e(this,t,rt,nt,i,{separation:5,labelMaker:0},et)}get separation(){return this.$$.ctx[5]}set separation(t){this.$$set({separation:t}),s()}get labelMaker(){return this.$$.ctx[0]}set labelMaker(t){this.$$set({labelMaker:t}),s()}}function at(t){n(t,"svelte-133qdtd","g.svelte-133qdtd{paint-order:stroke;stroke-width:3px;stroke:var(--visual-math-line-color);stroke-opacity:0.75}")}function ct(t,e,i){const s=t.slice();return s[9]=e[i],s}function lt(t){let e,i,s,n,d=(t[0]?t[0](t[9]):t[9])+"";return{c(){e=r("text"),i=o(d),a(e,"x",s=5),a(e,"y",n=t[1](t[9])),a(e,"alignment-baseline","central")},m(t,s){c(t,e,s),l(e,i)},p(t,s){5&s&&d!==(d=(t[0]?t[0](t[9]):t[9])+"")&&h(i,d),6&s&&n!==(n=t[1](t[9]))&&a(e,"y",n)},d(t){t&&u(e)}}}function ht(t){let e,i=t[2],s=[];for(let e=0;e<i.length;e+=1)s[e]=lt(ct(t,i,e));return{c(){e=r("g");for(let t=0;t<s.length;t+=1)s[t].c();a(e,"class","svelte-133qdtd")},m(t,i){c(t,e,i);for(let t=0;t<s.length;t+=1)s[t].m(e,null)},p(t,[n]){if(7&n){let r;for(i=t[2],r=0;r<i.length;r+=1){const o=ct(t,i,r);s[r]?s[r].p(o,n):(s[r]=lt(o),s[r].c(),s[r].m(e,null))}for(;r<s.length;r+=1)s[r].d(1);s.length=i.length}},i:d,o:d,d(t){t&&u(e),p(s,t)}}}function ut(t,e,i){let s,n,r,o,a,{separation:c}=e,{labelMaker:l}=e,h=N();$(t,h,(t=>i(8,a=t)));let u=Z();return $(t,u,(t=>i(7,o=t))),t.$$set=t=>{"separation"in t&&i(5,c=t.separation),"labelMaker"in t&&i(0,l=t.labelMaker)},t.$$.update=()=>{256&t.$$.dirty&&i(1,s=a.scaleY),128&t.$$.dirty&&i(6,n=o.yPanes),98&t.$$.dirty&&i(2,r=tt(n[0][0]-c,n[n.length-1][1]+c,c).filter((t=>Math.abs(s(t)-s(0))>1)))},[l,s,r,h,u,c,n,o,a]}class dt extends t{constructor(t){super(),e(this,t,ut,ht,i,{separation:5,labelMaker:0},at)}get separation(){return this.$$.ctx[5]}set separation(t){this.$$set({separation:t}),s()}get labelMaker(){return this.$$.ctx[0]}set labelMaker(t){this.$$set({labelMaker:t}),s()}}function pt(t,e,i){const s=t.slice();return s[13]=e[i],s}function $t(t,e,i){const s=t.slice();return s[16]=e[i],s}function ft(t){let e,i,s,n,o;return{c(){e=r("line"),a(e,"x1",i=t[16]),a(e,"y1",s=0),a(e,"x2",n=t[16]),a(e,"y2",t[3]),a(e,"style",o="stroke: var(--grid-line-subdivision-color)")},m(t,i){c(t,e,i)},p(t,s){32&s&&i!==(i=t[16])&&a(e,"x1",i),32&s&&n!==(n=t[16])&&a(e,"x2",n),8&s&&a(e,"y2",t[3])},d(t){t&&u(e)}}}function gt(t){let e,i,s,n,o;return{c(){e=r("line"),a(e,"y1",i=t[13]),a(e,"x1",s=0),a(e,"y2",n=t[13]),a(e,"x2",t[4]),a(e,"style",o="stroke: var(--grid-line-subdivision-color)")},m(t,i){c(t,e,i)},p(t,s){64&s&&i!==(i=t[13])&&a(e,"y1",i),64&s&&n!==(n=t[13])&&a(e,"y2",n),16&s&&a(e,"x2",t[4])},d(t){t&&u(e)}}}function yt(t){let e,i,s,n,o,l,h,d;return{c(){e=r("line"),l=r("line"),a(e,"x1",i=0),a(e,"y1",s=0),a(e,"x2",n=0),a(e,"y2",t[3]),a(e,"style",o="stroke: var(--visual-math-line-color)"),a(l,"x1",t[4]),a(l,"y1",h=0),a(l,"x2",t[4]),a(l,"y2",t[3]),a(l,"style",d="stroke: var(--visual-math-line-color)")},m(t,i){c(t,e,i),c(t,l,i)},p(t,i){8&i&&a(e,"y2",t[3]),16&i&&a(l,"x1",t[4]),16&i&&a(l,"x2",t[4]),8&i&&a(l,"y2",t[3])},d(t){t&&u(e),t&&u(l)}}}function mt(t){let e,i,s,n,o,l,h,d;return{c(){e=r("line"),l=r("line"),a(e,"x1",i=0),a(e,"y1",s=0),a(e,"x2",t[4]),a(e,"y2",n=0),a(e,"style",o="stroke: var(--visual-math-line-color)"),a(l,"x1",h=0),a(l,"y1",t[3]),a(l,"x2",t[4]),a(l,"y2",t[3]),a(l,"style",d="stroke: var(--visual-math-line-color)")},m(t,i){c(t,e,i),c(t,l,i)},p(t,i){16&i&&a(e,"x2",t[4]),8&i&&a(l,"y1",t[3]),16&i&&a(l,"x2",t[4]),8&i&&a(l,"y2",t[3])},d(t){t&&u(e),t&&u(l)}}}function vt(t){let e,i,s,n,o=t[5],h=[];for(let e=0;e<o.length;e+=1)h[e]=ft($t(t,o,e));let $=t[6],g=[];for(let e=0;e<$.length;e+=1)g[e]=gt(pt(t,$,e));let y=t[1]&&yt(t),m=t[2]&&mt(t);return{c(){e=r("pattern");for(let t=0;t<h.length;t+=1)h[t].c();i=f();for(let t=0;t<g.length;t+=1)g[t].c();s=f(),y&&y.c(),n=f(),m&&m.c(),a(e,"id",t[0]),a(e,"x","0"),a(e,"y","0"),a(e,"width",t[4]),a(e,"height",t[3]),a(e,"patternUnits","userSpaceOnUse")},m(t,r){c(t,e,r);for(let t=0;t<h.length;t+=1)h[t].m(e,null);l(e,i);for(let t=0;t<g.length;t+=1)g[t].m(e,null);l(e,s),y&&y.m(e,null),l(e,n),m&&m.m(e,null)},p(t,[r]){if(40&r){let s;for(o=t[5],s=0;s<o.length;s+=1){const n=$t(t,o,s);h[s]?h[s].p(n,r):(h[s]=ft(n),h[s].c(),h[s].m(e,i))}for(;s<h.length;s+=1)h[s].d(1);h.length=o.length}if(80&r){let i;for($=t[6],i=0;i<$.length;i+=1){const n=pt(t,$,i);g[i]?g[i].p(n,r):(g[i]=gt(n),g[i].c(),g[i].m(e,s))}for(;i<g.length;i+=1)g[i].d(1);g.length=$.length}t[1]?y?y.p(t,r):(y=yt(t),y.c(),y.m(e,n)):y&&(y.d(1),y=null),t[2]?m?m.p(t,r):(m=mt(t),m.c(),m.m(e,null)):m&&(m.d(1),m=null),1&r&&a(e,"id",t[0]),16&r&&a(e,"width",t[4]),8&r&&a(e,"height",t[3])},i:d,o:d,d(t){t&&u(e),p(h,t),p(g,t),y&&y.d(),m&&m.d()}}}function xt(t,e,i){let s,n,r,o,a,{id:c}=e,{xLines:l=1}=e,{yLines:h=1}=e,{xSubdivisions:u=1}=e,{ySubdivisions:d=1}=e,p=N();$(t,p,(t=>i(12,a=t)));let f=[],g=[];return t.$$set=t=>{"id"in t&&i(0,c=t.id),"xLines"in t&&i(1,l=t.xLines),"yLines"in t&&i(2,h=t.yLines),"xSubdivisions"in t&&i(8,u=t.xSubdivisions),"ySubdivisions"in t&&i(9,d=t.ySubdivisions)},t.$$.update=()=>{if(4096&t.$$.dirty&&i(11,s=a.scaleX),4096&t.$$.dirty&&i(10,n=a.scaleY),2050&t.$$.dirty&&i(4,r=s(l||1)),1028&t.$$.dirty&&i(3,o=-n(h||1)),272&t.$$.dirty&&u&&u>1){const t=r/u;i(5,f=z(0,r+1.1*t,t).iter().toArray())}if(520&t.$$.dirty&&d&&d>1){const t=o/d;i(6,g=z(0,o+1.1*t,t).iter().toArray())}},[c,l,h,o,r,f,g,p,u,d,n,s,a]}class bt extends t{constructor(t){super(),e(this,t,xt,vt,i,{id:0,xLines:1,yLines:2,xSubdivisions:8,ySubdivisions:9})}get id(){return this.$$.ctx[0]}set id(t){this.$$set({id:t}),s()}get xLines(){return this.$$.ctx[1]}set xLines(t){this.$$set({xLines:t}),s()}get yLines(){return this.$$.ctx[2]}set yLines(t){this.$$set({yLines:t}),s()}get xSubdivisions(){return this.$$.ctx[8]}set xSubdivisions(t){this.$$set({xSubdivisions:t}),s()}get ySubdivisions(){return this.$$.ctx[9]}set ySubdivisions(t){this.$$set({ySubdivisions:t}),s()}}function wt(t){n(t,"svelte-xqsvde","line.svelte-xqsvde{stroke:var(--visual-math-origin-color)}")}function kt(t){let e,i;return e=new ot({props:{labelMaker:t[3].labels,separation:t[3].lines||1}}),{c(){g(e.$$.fragment)},m(t,s){y(e,t,s),i=!0},p(t,i){const s={};8&i&&(s.labelMaker=t[3].labels),8&i&&(s.separation=t[3].lines||1),e.$set(s)},i(t){i||(m(e.$$.fragment,t),i=!0)},o(t){v(e.$$.fragment,t),i=!1},d(t){x(e,t)}}}function Ot(t){let e,i;return e=new dt({props:{labelMaker:t[2].labels,separation:t[2].lines||1}}),{c(){g(e.$$.fragment)},m(t,s){y(e,t,s),i=!0},p(t,i){const s={};4&i&&(s.labelMaker=t[2].labels),4&i&&(s.separation=t[2].lines||1),e.$set(s)},i(t){i||(m(e.$$.fragment,t),i=!0)},o(t){v(e.$$.fragment,t),i=!1},d(t){x(e,t)}}}function St(t){let e,i,s,n,o;return{c(){e=r("line"),a(e,"x1",i=-1e7),a(e,"x2",s=1e7),a(e,"y1",n=0),a(e,"y2",o=0),a(e,"class","transform-y-to-center svelte-xqsvde")},m(t,i){c(t,e,i)},d(t){t&&u(e)}}}function _t(t){let e,i,s,n,o;return{c(){e=r("line"),a(e,"x1",i=0),a(e,"x2",s=0),a(e,"y1",n=-1e7),a(e,"y2",o=1e7),a(e,"class","transform-x-to-center svelte-xqsvde")},m(t,i){c(t,e,i)},d(t){t&&u(e)}}}function Mt(t){let e,i,s,n,o,l,h,d,p,$;i=new bt({props:{id:t[4],xLines:t[3].lines,yLines:t[2].lines,xSubdivisions:t[3].subdivisions,ySubdivisions:t[2].subdivisions}});let O=t[0].labels&&kt(t),S=t[1].labels&&Ot(t),_=t[3].axis&&St(),M=t[2].axis&&_t();return{c(){e=r("defs"),g(i.$$.fragment),s=b(),n=r("rect"),o=b(),O&&O.c(),l=b(),S&&S.c(),h=b(),_&&_.c(),d=b(),M&&M.c(),p=f(),a(n,"fill",`url(#${t[4]})`),a(n,"x",-1e7),a(n,"y",-1e7),a(n,"width",2e7),a(n,"height",2e7)},m(t,r){c(t,e,r),y(i,e,null),c(t,s,r),c(t,n,r),c(t,o,r),O&&O.m(t,r),c(t,l,r),S&&S.m(t,r),c(t,h,r),_&&_.m(t,r),c(t,d,r),M&&M.m(t,r),c(t,p,r),$=!0},p(t,[e]){const s={};8&e&&(s.xLines=t[3].lines),4&e&&(s.yLines=t[2].lines),8&e&&(s.xSubdivisions=t[3].subdivisions),4&e&&(s.ySubdivisions=t[2].subdivisions),i.$set(s),t[0].labels?O?(O.p(t,e),1&e&&m(O,1)):(O=kt(t),O.c(),m(O,1),O.m(l.parentNode,l)):O&&(w(),v(O,1,1,(()=>{O=null})),k()),t[1].labels?S?(S.p(t,e),2&e&&m(S,1)):(S=Ot(t),S.c(),m(S,1),S.m(h.parentNode,h)):S&&(w(),v(S,1,1,(()=>{S=null})),k()),t[3].axis?_||(_=St(),_.c(),_.m(d.parentNode,d)):_&&(_.d(1),_=null),t[2].axis?M||(M=_t(),M.c(),M.m(p.parentNode,p)):M&&(M.d(1),M=null)},i(t){$||(m(i.$$.fragment,t),m(O),m(S),$=!0)},o(t){v(i.$$.fragment,t),v(O),v(S),$=!1},d(t){t&&u(e),x(i),t&&u(s),t&&u(n),t&&u(o),O&&O.d(t),t&&u(l),S&&S.d(t),t&&u(h),_&&_.d(t),t&&u(d),M&&M.d(t),t&&u(p)}}}let At=0;const Pt={axis:!0,lines:1,labels:t=>t};function Et(t,e,i){let s,n,{subdivisions:r=!1}=e,{xAxis:o=Object.assign({subdivisions:r},Pt)}=e,{yAxis:a=Object.assign({subdivisions:r},Pt)}=e;const c="visual-math-grid-"+At++;return t.$$set=t=>{"subdivisions"in t&&i(5,r=t.subdivisions),"xAxis"in t&&i(0,o=t.xAxis),"yAxis"in t&&i(1,a=t.yAxis)},t.$$.update=()=>{33&t.$$.dirty&&i(3,s=Object.assign(Object.assign({subdivisions:r},Pt),o)),34&t.$$.dirty&&i(2,n=Object.assign(Object.assign({subdivisions:r},Pt),a))},[o,a,n,s,c,r]}class jt extends t{constructor(t){super(),e(this,t,Et,Mt,i,{subdivisions:5,xAxis:0,yAxis:1},wt)}get subdivisions(){return this.$$.ctx[5]}set subdivisions(t){this.$$set({subdivisions:t}),s()}get xAxis(){return this.$$.ctx[0]}set xAxis(t){this.$$set({xAxis:t}),s()}get yAxis(){return this.$$.ctx[1]}set yAxis(t){this.$$set({yAxis:t}),s()}}function Tt(t){n(t,"svelte-cc8k9r","ellipse.svelte-cc8k9r{vector-effect:non-scaling-stroke}")}function Lt(t){let e,i,s,n,o,a,l,h,p=[{cx:i=t[0][0]},{cy:s=t[0][1]},{rx:n=Math.abs(t[1][0])},{ry:o=Math.abs(t[1][1])},{"stroke-width":t[4]},{"stroke-dasharray":a="dashed"===t[2]?"4,3":void 0},{transform:l=`${t[8]} ${t[7]}`},t[10],{style:h=`\n    stroke: ${t[5]};\n    fill: ${t[5]};\n    fill-opacity: ${t[6]};\n    stroke-opacity: ${t[3]};\n    ${t[10].style||""}\n  `}],$={};for(let t=0;t<p.length;t+=1)$=O($,p[t]);return{c(){e=r("ellipse"),S(e,$),_(e,"svelte-cc8k9r",!0)},m(t,i){c(t,e,i)},p(t,[r]){S(e,$=M(p,[1&r&&i!==(i=t[0][0])&&{cx:i},1&r&&s!==(s=t[0][1])&&{cy:s},2&r&&n!==(n=Math.abs(t[1][0]))&&{rx:n},2&r&&o!==(o=Math.abs(t[1][1]))&&{ry:o},16&r&&{"stroke-width":t[4]},4&r&&a!==(a="dashed"===t[2]?"4,3":void 0)&&{"stroke-dasharray":a},384&r&&l!==(l=`${t[8]} ${t[7]}`)&&{transform:l},1024&r&&t[10],1128&r&&h!==(h=`\n    stroke: ${t[5]};\n    fill: ${t[5]};\n    fill-opacity: ${t[6]};\n    stroke-opacity: ${t[3]};\n    ${t[10].style||""}\n  `)&&{style:h}])),_(e,"svelte-cc8k9r",!0)},i:d,o:d,d(t){t&&u(e)}}}function Dt(t,e,i){let s,n;const r=["center","radius","angle","strokeStyle","strokeOpacity","weight","color","fillOpacity"];let o,a=A(e,r),{center:c=U.fromValues(0,0)}=e,{radius:l=U.fromValues(1,1)}=e,{angle:h=0}=e,{strokeStyle:u="solid"}=e,{strokeOpacity:d=1}=e,{weight:p=2}=e,{color:f="var(--visual-math-fg)"}=e,{fillOpacity:g=.15}=e,y=N();return $(t,y,(t=>i(12,o=t))),t.$$set=t=>{e=O(O({},e),P(t)),i(10,a=A(e,r)),"center"in t&&i(0,c=t.center),"radius"in t&&i(1,l=t.radius),"angle"in t&&i(11,h=t.angle),"strokeStyle"in t&&i(2,u=t.strokeStyle),"strokeOpacity"in t&&i(3,d=t.strokeOpacity),"weight"in t&&i(4,p=t.weight),"color"in t&&i(5,f=t.color),"fillOpacity"in t&&i(6,g=t.fillOpacity)},t.$$.update=()=>{4096&t.$$.dirty&&i(8,s=o.cssScale),2049&t.$$.dirty&&i(7,n=`rotate(${180*h/Math.PI} ${c[0]} ${c[1]})`)},[c,l,u,d,p,f,g,n,s,y,a,h,o]}class Ct extends t{constructor(t){super(),e(this,t,Dt,Lt,i,{center:0,radius:1,angle:11,strokeStyle:2,strokeOpacity:3,weight:4,color:5,fillOpacity:6},Tt)}get center(){return this.$$.ctx[0]}set center(t){this.$$set({center:t}),s()}get radius(){return this.$$.ctx[1]}set radius(t){this.$$set({radius:t}),s()}get angle(){return this.$$.ctx[11]}set angle(t){this.$$set({angle:t}),s()}get strokeStyle(){return this.$$.ctx[2]}set strokeStyle(t){this.$$set({strokeStyle:t}),s()}get strokeOpacity(){return this.$$.ctx[3]}set strokeOpacity(t){this.$$set({strokeOpacity:t}),s()}get weight(){return this.$$.ctx[4]}set weight(t){this.$$set({weight:t}),s()}get color(){return this.$$.ctx[5]}set color(t){this.$$set({color:t}),s()}get fillOpacity(){return this.$$.ctx[6]}set fillOpacity(t){this.$$set({fillOpacity:t}),s()}}function It(t){let e,i;const s=[{center:t[0]},{radius:t[7]},{angle:t[1]},{strokeStyle:t[2]},{strokeOpacity:t[3]},{weight:t[4]},{color:t[5]},{fillOpacity:t[6]},t[8]];let n={};for(let t=0;t<s.length;t+=1)n=O(n,s[t]);return e=new Ct({props:n}),{c(){g(e.$$.fragment)},m(t,s){y(e,t,s),i=!0},p(t,[i]){const n=511&i?M(s,[1&i&&{center:t[0]},128&i&&{radius:t[7]},2&i&&{angle:t[1]},4&i&&{strokeStyle:t[2]},8&i&&{strokeOpacity:t[3]},16&i&&{weight:t[4]},32&i&&{color:t[5]},64&i&&{fillOpacity:t[6]},256&i&&E(t[8])]):{};e.$set(n)},i(t){i||(m(e.$$.fragment,t),i=!0)},o(t){v(e.$$.fragment,t),i=!1},d(t){x(e,t)}}}function Kt(t,e,i){const s=["center","radius","angle","strokeStyle","strokeOpacity","weight","color","fillOpacity"];let n=A(e,s),{center:r=U.fromValues(0,0)}=e,{radius:o=1}=e,{angle:a=0}=e,{strokeStyle:c="solid"}=e,{strokeOpacity:l=1}=e,{weight:h=2}=e,{color:u="var(--visual-math-fg)"}=e,{fillOpacity:d=.15}=e,p=U.fromValues(o,o);return t.$$set=t=>{e=O(O({},e),P(t)),i(8,n=A(e,s)),"center"in t&&i(0,r=t.center),"radius"in t&&i(9,o=t.radius),"angle"in t&&i(1,a=t.angle),"strokeStyle"in t&&i(2,c=t.strokeStyle),"strokeOpacity"in t&&i(3,l=t.strokeOpacity),"weight"in t&&i(4,h=t.weight),"color"in t&&i(5,u=t.color),"fillOpacity"in t&&i(6,d=t.fillOpacity)},t.$$.update=()=>{640&t.$$.dirty&&i(7,p=U.set(p,o,o))},[r,a,c,l,h,u,d,p,n,o]}class Vt extends t{constructor(t){super(),e(this,t,Kt,It,i,{center:0,radius:9,angle:1,strokeStyle:2,strokeOpacity:3,weight:4,color:5,fillOpacity:6})}get center(){return this.$$.ctx[0]}set center(t){this.$$set({center:t}),s()}get radius(){return this.$$.ctx[9]}set radius(t){this.$$set({radius:t}),s()}get angle(){return this.$$.ctx[1]}set angle(t){this.$$set({angle:t}),s()}get strokeStyle(){return this.$$.ctx[2]}set strokeStyle(t){this.$$set({strokeStyle:t}),s()}get strokeOpacity(){return this.$$.ctx[3]}set strokeOpacity(t){this.$$set({strokeOpacity:t}),s()}get weight(){return this.$$.ctx[4]}set weight(t){this.$$set({weight:t}),s()}get color(){return this.$$.ctx[5]}set color(t){this.$$set({color:t}),s()}get fillOpacity(){return this.$$.ctx[6]}set fillOpacity(t){this.$$set({fillOpacity:t}),s()}}const zt={toVector:(t,e)=>(void 0===t&&(t=e),Array.isArray(t)?t:[t,t]),add:(t,e)=>[t[0]+e[0],t[1]+e[1]],sub:(t,e)=>[t[0]-e[0],t[1]-e[1]],addTo(t,e){t[0]+=e[0],t[1]+=e[1]},subTo(t,e){t[0]-=e[0],t[1]-=e[1]}};function Yt(t,e,i){return 0===e||Math.abs(e)===1/0?Math.pow(t,5*i):t*e*i/(e+i*t)}function qt(t,e,i,s=.15){return 0===s?function(t,e,i){return Math.max(e,Math.min(t,i))}(t,e,i):t<e?-Yt(e-t,i-e,s)+e:t>i?+Yt(t-i,i-e,s)+i:t}function Xt(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function Ut(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,s)}return i}function Ht(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?Ut(Object(i),!0).forEach((function(e){Xt(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):Ut(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}const Bt={pointer:{start:"down",change:"move",end:"up"},mouse:{start:"down",change:"move",end:"up"},touch:{start:"start",change:"move",end:"end"},gesture:{start:"start",change:"change",end:"end"}};function Rt(t){return t?t[0].toUpperCase()+t.slice(1):""}function Nt(t){return"touches"in t}function Gt(t){return Nt(t)?function(t){return"touchend"===t.type?t.changedTouches:t.targetTouches}(t)[0]:t}function Wt(t){return function(t){return Array.from(t.touches).filter((e=>{var i,s;return e.target===t.currentTarget||(null===(i=t.currentTarget)||void 0===i||null===(s=i.contains)||void 0===s?void 0:s.call(i,e.target))}))}(t).map((t=>t.identifier))}function Ft(t){const e=Gt(t);return Nt(t)?e.identifier:e.pointerId}function Jt(t){const e=Gt(t);return[e.clientX,e.clientY]}function Qt(t,...e){return"function"==typeof t?t(...e):t}function Zt(){}function te(...t){return 0===t.length?Zt:1===t.length?t[0]:function(){let e;for(const i of t)e=i.apply(this,arguments)||e;return e}}function ee(t,e){return Object.assign({},e,t||{})}class ie extends class{constructor(t,e,i){this.ctrl=t,this.args=e,this.key=i,this.state||(this.state={values:[0,0],initial:[0,0]},this.init&&this.init(),this.reset())}get state(){return this.ctrl.state[this.key]}set state(t){this.ctrl.state[this.key]=t}get shared(){return this.ctrl.state.shared}get eventStore(){return this.ctrl.gestureEventStores[this.key]}get timeoutStore(){return this.ctrl.gestureTimeoutStores[this.key]}get config(){return this.ctrl.config[this.key]}get sharedConfig(){return this.ctrl.config.shared}get handler(){return this.ctrl.handlers[this.key]}reset(){const{state:t,shared:e,config:i,ingKey:s,args:n}=this,{transform:r,threshold:o=[0,0]}=i;e[s]=t._active=t.active=t._blocked=t._force=!1,t._step=[!1,!1],t.intentional=!1,t._movement=[0,0],t._distance=[0,0],t._delta=[0,0],t._threshold=zt.sub(r(o),r([0,0])).map(Math.abs),t._bounds=[[-1/0,1/0],[-1/0,1/0]],t.args=n,t.axis=void 0,t.memo=void 0,t.elapsedTime=0,t.direction=[0,0],t.distance=[0,0],t.velocity=[0,0],t.movement=[0,0],t.delta=[0,0],t.timeStamp=0}start(t){const e=this.state,i=this.config;e._active||(this.reset(),e._active=!0,e.target=t.target,e.currentTarget=t.currentTarget,e.initial=e.values,e.lastOffset=i.from?Qt(i.from,e):e.offset,e.offset=e.lastOffset),e.startTime=e.timeStamp=t.timeStamp}compute(t){const{state:e,config:i,shared:s}=this;e.args=this.args;let n=0;if(t&&(e.event=t,e.type=t.type,s.touches=this.ctrl.pointerIds.size||this.ctrl.touchIds.size,s.locked=!!document.pointerLockElement,Object.assign(s,function(t){const e={};if("buttons"in t&&(e.buttons=t.buttons),"shiftKey"in t){const{shiftKey:i,altKey:s,metaKey:n,ctrlKey:r}=t;Object.assign(e,{shiftKey:i,altKey:s,metaKey:n,ctrlKey:r})}return e}(t)),s.down=s.pressed=s.buttons%2==1||s.touches>0,n=t.timeStamp-e.timeStamp,e.timeStamp=t.timeStamp,e.elapsedTime=e.timeStamp-e.startTime),e._active){const t=e._delta.map(Math.abs);zt.addTo(e._distance,t)}const[r,o]=i.transform(e._movement),[a,c]=e._threshold;let[l,h]=e._step;if(!1===l&&(l=Math.abs(r)>=a&&Math.sign(r)*a),!1===h&&(h=Math.abs(o)>=c&&Math.sign(o)*c),e.intentional=!1!==l||!1!==h,!e.intentional)return;e._step=[l,h];const u=[0,0];if(u[0]=!1!==l?r-l:0,u[1]=!1!==h?o-h:0,this.intent&&this.intent(u),(e._active&&!e._blocked||e.active)&&(e.first=e._active&&!e.active,e.last=!e._active&&e.active,e.active=s[this.ingKey]=e._active,t)){e.first&&("bounds"in i&&(e._bounds=Qt(i.bounds,e)),this.setup&&this.setup());const t=e.movement;if(e.movement=u,this.computeOffset(),!e.last){e.delta=zt.sub(u,t);const i=e.delta.map(Math.abs);zt.addTo(e.distance,i),e.direction=e.delta.map(Math.sign),!e.first&&n>0&&(e.velocity=[i[0]/n,i[1]/n])}}const d=e._active&&i.rubberband||[0,0];e.offset=function(t,[e,i],[s,n]){const[[r,o],[a,c]]=t;return[qt(e,r,o,s),qt(i,a,c,n)]}(e._bounds,e.offset,d),this.computeMovement()}emit(){const t=this.state,e=this.shared,i=this.config;if(t._active||this.clean(),(t._blocked||!t.intentional)&&!t._force&&!i.triggerAllEvents)return;const s=this.handler(Ht(Ht(Ht({},e),t),{},{[this.aliasKey]:t.values}));void 0!==s&&(t.memo=s)}clean(){this.eventStore.clean(),this.timeoutStore.clean()}}{constructor(...t){super(...t),Xt(this,"aliasKey","xy")}reset(){super.reset(),this.state.axis=void 0}init(){this.state.offset=[0,0],this.state.lastOffset=[0,0]}computeOffset(){this.state.offset=zt.add(this.state.lastOffset,this.state.movement)}computeMovement(){this.state.movement=zt.sub(this.state.offset,this.state.lastOffset)}intent(t){this.state.axis=this.state.axis||function([t,e]){const i=Math.abs(t)-Math.abs(e);return i>0?"x":i<0?"y":void 0}(t),this.state._blocked=(this.config.lockDirection||!!this.config.axis)&&!this.state.axis||!!this.config.axis&&this.config.axis!==this.state.axis,this.state._blocked||(this.config.axis||this.config.lockDirection)&&function(t,e){switch(e){case"x":t[1]=0;break;case"y":t[0]=0}}(t,this.state.axis)}}const se={enabled:(t=!0)=>t,triggerAllEvents:(t=!1)=>t,rubberband(t=0){switch(t){case!0:return[.15,.15];case!1:return[0,0];default:return zt.toVector(t)}},from:t=>"function"==typeof t?t:null!=t?zt.toVector(t):void 0,transform:(t,e,i)=>t||i.shared.transform},ne=Ht(Ht({},se),{},{axis(t,e,{axis:i}){if(this.lockDirection="lock"===i,!this.lockDirection)return i},bounds(t={}){if("function"==typeof t)return e=>ne.bounds(t(e));if("current"in t)return()=>t.current;if("function"==typeof HTMLElement&&t instanceof HTMLElement)return t;const{left:e=-1/0,right:i=1/0,top:s=-1/0,bottom:n=1/0}=t;return[[e,i],[s,n]]}}),re={ArrowRight:(t=1)=>[10*t,0],ArrowLeft:(t=1)=>[-10*t,0],ArrowUp:(t=1)=>[0,-10*t],ArrowDown:(t=1)=>[0,10*t]};const oe="undefined"!=typeof window&&window.document&&window.document.createElement;function ae(){return oe&&"ontouchstart"in window}const ce={isBrowser:oe,gesture:function(){try{return"constructor"in GestureEvent}catch(t){return!1}}(),touch:ae(),touchscreen:ae()||oe&&navigator.maxTouchPoints>1,pointer:oe&&"onpointerdown"in window,pointerLock:oe&&"exitPointerLock"in window.document},le=Ht(Ht({},ne),{},{pointerLock(t,e,{pointer:{lock:i=!1,touch:s=!1}={}}){return this.useTouch=ce.touch&&s,ce.pointerLock&&i},device(t,e){return this.useTouch?"touch":this.pointerLock?"mouse":ce.pointer?"pointer":ce.touch?"touch":"mouse"},preventScroll(t=!1,e,{preventScrollAxis:i="y"}){return i&&(this.preventScrollAxis=i),!!ce.touchscreen&&("number"==typeof t?t:!!t&&250)},pointerCapture(t,e,{pointer:{capture:i=!0}={}}){return!this.pointerLock&&"pointer"===this.device&&i},threshold(t,e,{filterTaps:i=!1,axis:s}){const n=zt.toVector(t,i?3:s?1:0);return this.filterTaps=i,n},swipe({velocity:t=.5,distance:e=50,duration:i=250}={}){return{velocity:this.transform(zt.toVector(t)),distance:this.transform(zt.toVector(e)),duration:i}},delay(t=0){switch(t){case!0:return 180;case!1:return 0;default:return t}}});Ht(Ht({},se),{},{useTouch:(t,e,{pointer:{touch:i=!1}={}})=>ce.touch&&i,device(t,e,i){if(i.shared.target&&!ce.touch&&ce.gesture)return"gesture";if(this.useTouch)return"touch";if(ce.touchscreen){if(ce.pointer)return"pointer";if(ce.touch)return"touch"}},bounds(t,e,{scaleBounds:i={},angleBounds:s={}}){const n=t=>{const e=ee(Qt(i,t),{min:-1/0,max:1/0});return[e.min,e.max]},r=t=>{const e=ee(Qt(s,t),{min:-1/0,max:1/0});return[e.min,e.max]};return"function"!=typeof i&&"function"!=typeof s?[n(),r()]:t=>[n(t),r(t)]},threshold(t,e,i){this.lockDirection="lock"===i.axis;return zt.toVector(t,this.lockDirection?[.1,3]:0)}}),Ht(Ht({},ne),{},{mouseOnly:(t=!0)=>t});const he=ne;Ht(Ht({},ne),{},{mouseOnly:(t=!0)=>t});const ue=new Map,de=new Map;function pe(t){ue.set(t.key,t.engine),de.set(t.key,t.resolver)}const $e={key:"drag",engine:class extends ie{constructor(...t){super(...t),Xt(this,"ingKey","dragging")}reset(){super.reset();const t=this.state;t._pointerId=void 0,t._pointerActive=!1,t._keyboardActive=!1,t._preventScroll=!1,t._delayed=!1,t.swipe=[0,0],t.tap=!1,t.canceled=!1,t.cancel=this.cancel.bind(this)}setup(){const t=this.state;if(t._bounds instanceof HTMLElement){const e=t._bounds.getBoundingClientRect(),i=t.currentTarget.getBoundingClientRect(),s={left:e.left-i.left+t.offset[0],right:e.right-i.right+t.offset[0],top:e.top-i.top+t.offset[1],bottom:e.bottom-i.bottom+t.offset[1]};t._bounds=ne.bounds(s)}}cancel(){const t=this.state;t.canceled||setTimeout((()=>{t.canceled=!0,t._active=!1,this.compute(),this.emit()}),0)}setActive(){this.state._active=this.state._pointerActive||this.state._keyboardActive}clean(){this.pointerClean(),this.state._pointerActive=!1,this.state._keyboardActive=!1,super.clean()}pointerDown(t){if(null!=t.buttons&&t.buttons%2!=1)return;this.ctrl.setEventIds(t),this.config.pointerCapture&&t.target.setPointerCapture(t.pointerId);const e=this.state,i=this.config;e._pointerActive||(this.start(t),this.setupPointer(t),e._pointerId=Ft(t),e._pointerActive=!0,e.values=Jt(t),e.initial=e.values,i.preventScroll?this.setupScrollPrevention(t):i.delay>0?this.setupDelayTrigger(t):this.startPointerDrag(t))}startPointerDrag(t){const e=this.state;e._active=!0,e._preventScroll=!0,e._delayed=!1,this.compute(t),this.emit()}pointerMove(t){const e=this.state,i=this.config;if(!e._pointerActive)return;if(e.type===t.type&&t.timeStamp===e.timeStamp)return;const s=Ft(t);if(e._pointerId&&s!==e._pointerId)return;const n=Jt(t);return document.pointerLockElement===t.target?e._delta=[t.movementX,t.movementY]:(e._delta=zt.sub(n,e.values),e.values=n),zt.addTo(e._movement,e._delta),this.compute(t),e._delayed?(this.timeoutStore.remove("dragDelay"),void this.startPointerDrag(t)):i.preventScroll&&!e._preventScroll?e.axis?e.axis===i.preventScrollAxis||"xy"===i.preventScrollAxis?(e._active=!1,void this.clean()):(this.timeoutStore.remove("startPointerDrag"),void this.startPointerDrag(t)):void 0:void this.emit()}pointerUp(t){this.ctrl.setEventIds(t);try{this.config.pointerCapture&&t.target.hasPointerCapture(t.pointerId)&&t.target.releasePointerCapture(t.pointerId)}catch(t){}const e=this.state,i=this.config;if(!e._pointerActive)return;const s=Ft(t);if(e._pointerId&&s!==e._pointerId)return;this.state._pointerActive=!1,this.setActive(),this.compute(t);const[n,r]=e._distance;if(e.tap=n<=3&&r<=3,e.tap&&i.filterTaps)e._force=!0;else{const[t,s]=e.direction,[n,r]=e.velocity,[o,a]=e.movement,[c,l]=i.swipe.velocity,[h,u]=i.swipe.distance,d=i.swipe.duration;e.elapsedTime<d&&(Math.abs(n)>c&&Math.abs(o)>h&&(e.swipe[0]=t),Math.abs(r)>l&&Math.abs(a)>u&&(e.swipe[1]=s))}this.emit()}pointerClick(t){this.state.tap||(t.preventDefault(),t.stopPropagation())}setupPointer(t){const e=this.config;let i=e.device;e.pointerLock&&t.currentTarget.requestPointerLock(),e.pointerCapture||(this.eventStore.add(this.sharedConfig.window,i,"change",this.pointerMove.bind(this)),this.eventStore.add(this.sharedConfig.window,i,"end",this.pointerUp.bind(this)))}pointerClean(){this.config.pointerLock&&document.pointerLockElement===this.state.currentTarget&&document.exitPointerLock()}preventScroll(t){this.state._preventScroll&&t.cancelable&&t.preventDefault()}setupScrollPrevention(t){!function(t){"persist"in t&&"function"==typeof t.persist&&t.persist()}(t),this.eventStore.add(this.sharedConfig.window,"touch","change",this.preventScroll.bind(this),{passive:!1}),this.eventStore.add(this.sharedConfig.window,"touch","end",this.clean.bind(this),{passive:!1}),this.eventStore.add(this.sharedConfig.window,"touch","cancel",this.clean.bind(this),{passive:!1}),this.timeoutStore.add("startPointerDrag",this.startPointerDrag.bind(this),this.config.preventScroll,t)}setupDelayTrigger(t){this.state._delayed=!0,this.timeoutStore.add("dragDelay",this.startPointerDrag.bind(this),this.config.delay,t)}keyDown(t){const e=re[t.key],i=this.state;if(e){const s=t.shiftKey?10:t.altKey?.1:1;i._delta=e(s),this.start(t),i._keyboardActive=!0,zt.addTo(i._movement,i._delta),this.compute(t),this.emit()}}keyUp(t){t.key in re&&(this.state._keyboardActive=!1,this.setActive(),this.compute(t),this.emit())}bind(t){const e=this.config.device;t(e,"start",this.pointerDown.bind(this)),this.config.pointerCapture&&(t(e,"change",this.pointerMove.bind(this)),t(e,"end",this.pointerUp.bind(this)),t(e,"cancel",this.pointerUp.bind(this))),t("key","down",this.keyDown.bind(this)),t("key","up",this.keyUp.bind(this)),this.config.filterTaps&&t("click","",this.pointerClick.bind(this),{capture:!0})}},resolver:le},fe={key:"wheel",engine:class extends ie{constructor(...t){super(...t),Xt(this,"ingKey","wheeling")}wheel(t){this.state._active||this.start(t),this.wheelChange(t),this.timeoutStore.add("wheelEnd",this.wheelEnd.bind(this))}wheelChange(t){const e=this.state;e._delta=function(t){let{deltaX:e,deltaY:i,deltaMode:s}=t;return 1===s?(e*=40,i*=40):2===s&&(e*=800,i*=800),[e,i]}(t),zt.addTo(this.state._movement,e._delta),this.compute(t),this.emit()}wheelEnd(){this.state._active&&(this.state._active=!1,this.compute(),this.emit())}bind(t){t("wheel","",this.wheel.bind(this))}},resolver:he};function ge(t,e){if(null==t)return{};var i,s,n=function(t,e){if(null==t)return{};var i,s,n={},r=Object.keys(t);for(s=0;s<r.length;s++)i=r[s],e.indexOf(i)>=0||(n[i]=t[i]);return n}(t,e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);for(s=0;s<r.length;s++)i=r[s],e.indexOf(i)>=0||Object.prototype.propertyIsEnumerable.call(t,i)&&(n[i]=t[i])}return n}const ye=t=>t,me={target(t){if(t)return()=>"current"in t?t.current:t},enabled:(t=!0)=>t,window:(t=(ce.isBrowser?window:void 0))=>t,eventOptions:({passive:t=!0,capture:e=!1}={})=>({passive:t,capture:e}),transform:(t=ye)=>t},ve=["target","eventOptions","window","enabled","transform"];function xe(t={},e){const i={};for(const[s,n]of Object.entries(e))switch(typeof n){case"function":i[s]=n.call(i,t[s],s,t);break;case"object":i[s]=xe(t[s],n);break;case"boolean":n&&(i[s]=t[s])}return i}class be{constructor(t){Xt(this,"_listeners",[]),this._ctrl=t}add(t,e,i,s,n){const r=function(t,e=""){const i=Bt[t];return t+(i&&i[e]||e)}(e,i),o=Ht(Ht({},this._ctrl.config.shared.eventOptions),n);t.addEventListener(r,s,o),this._listeners.push((()=>t.removeEventListener(r,s,o)))}clean(){this._listeners.forEach((t=>t())),this._listeners=[]}}class we{constructor(){Xt(this,"_timeouts",new Map)}add(t,e,i=140,...s){this.remove(t),this._timeouts.set(t,window.setTimeout(e,i,...s))}remove(t){const e=this._timeouts.get(t);e&&window.clearTimeout(e)}clean(){this._timeouts.forEach((t=>{window.clearTimeout(t)})),this._timeouts.clear()}}class ke{constructor(t){Xt(this,"gestures",new Set),Xt(this,"_targetEventStore",new be(this)),Xt(this,"gestureEventStores",{}),Xt(this,"gestureTimeoutStores",{}),Xt(this,"handlers",{}),Xt(this,"config",{}),Xt(this,"pointerIds",new Set),Xt(this,"touchIds",new Set),Xt(this,"state",{shared:{shiftKey:!1,metaKey:!1,ctrlKey:!1,altKey:!1}}),function(t,e){e.drag&&Oe(t,"drag");e.wheel&&Oe(t,"wheel");e.scroll&&Oe(t,"scroll");e.move&&Oe(t,"move");e.pinch&&Oe(t,"pinch");e.hover&&Oe(t,"hover")}(this,t)}setEventIds(t){Nt(t)?this.touchIds=new Set(Wt(t)):"pointerId"in t&&("pointerup"===t.type?this.pointerIds.delete(t.pointerId):this.pointerIds.add(t.pointerId))}applyHandlers(t,e){this.handlers=t,this.nativeHandlers=e}applyConfig(t,e){this.config=function(t,e){const i=t,{target:s,eventOptions:n,window:r,enabled:o,transform:a}=i,c=ge(i,ve),l={shared:xe({target:s,eventOptions:n,window:r,enabled:o},me)};if(e){const t=de.get(e);l[e]=xe(Ht({shared:l.shared},c),t)}else for(const t in c){const e=de.get(t);e&&(l[t]=xe(Ht({shared:l.shared},c[t]),e))}return l}(t,e)}clean(){this._targetEventStore.clean();for(const t of this.gestures)this.gestureEventStores[t].clean(),this.gestureTimeoutStores[t].clean()}effect(){return this.config.shared.target&&this.bind(),()=>this._targetEventStore.clean()}bind(...t){const e=this.config.shared,i=e.eventOptions,s={};let n;if(e.target&&(n=e.target(),!n))return;const r=Se(s,i,!!n);if(e.enabled){for(const e of this.gestures)if(this.config[e].enabled){new(ue.get(e))(this,t,e).bind(r)}for(const e in this.nativeHandlers)r(e,"",(i=>this.nativeHandlers[e](Ht(Ht({},this.state.shared),{},{event:i,args:t}))),void 0,!0)}for(const t in s)s[t]=te(...s[t]);if(!n)return s;for(const t in s){let e=t.substr(2).toLowerCase();const i=!!~e.indexOf("capture"),r=!!~e.indexOf("passive");(i||r)&&(e=e.replace(/capture|passive/g,"")),this._targetEventStore.add(n,e,"",s[t],{capture:i,passive:r})}}}function Oe(t,e){t.gestures.add(e),t.gestureEventStores[e]=new be(t),t.gestureTimeoutStores[e]=new we}const Se=(t,e,i)=>(s,n,r,o={},a=!1)=>{var c,l;const h=null!==(c=o.capture)&&void 0!==c?c:e.capture,u=null!==(l=o.passive)&&void 0!==l?l:e.passive;let d=a?s:function(t,e="",i=!1){const s=Bt[t],n=s&&s[e]||e;return"on"+Rt(t)+Rt(n)+(i?"Capture":"")}(s,n,h);i&&u&&(d+="Passive"),t[d]=t[d]||[],t[d].push(r)};function _e(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function Me(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,s)}return i}function Ae(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?Me(Object(i),!0).forEach((function(e){_e(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):Me(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}const Pe=function(t,e,i,s,n){this._gestureKey=s,this._ctrl=new ke(e),this._ctrl.applyHandlers(e,n),this._ctrl.applyConfig(Ae(Ae({},i),{},{target:t}),this._gestureKey),this._ctrl.effect()};Pe.prototype.destroy=function(){this._ctrl.clean()};const Ee=function(t,e,i={}){return pe($e),new Pe(t,{drag:e},i,"drag")},je=function(t,e,i={}){return pe(fe),new Pe(t,{wheel:e},i,"wheel")};function Te(t){let e,i,s,n,o,h,p;return{c(){e=r("g"),i=r("circle"),o=r("circle"),a(i,"cx",s=t[5](t[1][0])),a(i,"cy",n=t[4](t[1][1])),a(i,"r",30),a(i,"fill","transparent"),a(o,"cx",h=t[5](t[1][0])),a(o,"cy",p=t[4](t[1][1])),a(o,"r",6),a(o,"fill",t[0]),a(o,"stroke",t[0]),a(o,"stroke-opacity",.25),a(o,"tabindex",0),_(o,"draggable",t[3])},m(s,n){c(s,e,n),l(e,i),l(e,o),t[15](e)},p(t,[e]){34&e&&s!==(s=t[5](t[1][0]))&&a(i,"cx",s),18&e&&n!==(n=t[4](t[1][1]))&&a(i,"cy",n),34&e&&h!==(h=t[5](t[1][0]))&&a(o,"cx",h),18&e&&p!==(p=t[4](t[1][1]))&&a(o,"cy",p),1&e&&a(o,"fill",t[0]),1&e&&a(o,"stroke",t[0]),8&e&&_(o,"draggable",t[3])},i:d,o:d,d(i){i&&u(e),t[15](null)}}}const Le=U.create();function De(t,e,i){let s,n,r,o,a,{point:c=U.create()}=e,{color:l="var(--visual-math-blue)"}=e,{transform:h=H.create()}=e,{constrain:u}=e,d=U.fromValues(c[0],c[1]),p=t=>t;c=p(c);let f=N();$(t,f,(t=>i(14,a=t)));let g,y=U.create(),m=H.create(),v=U.create(),x=!1;return X((()=>{const t=new Ee(g,o);return()=>{t.destroy()}})),t.$$set=t=>{"point"in t&&i(7,c=t.point),"color"in t&&i(0,l=t.color),"transform"in t&&i(8,h=t.transform),"constrain"in t&&i(9,u=t.constrain)},t.$$.update=()=>{512&t.$$.dirty&&("horizontal"===u?i(10,p=([t,e])=>[t,d[1]]):"vertical"===u?i(10,p=([t,e])=>[d[0],e]):"function"==typeof u&&i(10,p=u)),16384&t.$$.dirty&&i(5,s=a.scaleX),16384&t.$$.dirty&&i(4,n=a.scaleY),16384&t.$$.dirty&&i(13,r=a.inversePixelMatrix),2304&t.$$.dirty&&i(11,m=H.invert(m,h)),15744&t.$$.dirty&&(o=t=>{var e;null===(e=t.event)||void 0===e||e.stopPropagation(),i(3,x=t.down);const s=U.transformMat2d(Le,t.movement,r);t.first&&i(12,v=U.transformMat2d(v,c,h)),U.add(c,v,s),U.transformMat2d(c,c,m),i(7,c=p(c))}),386&t.$$.dirty&&i(1,y=U.transformMat2d(y,c,h))},[l,y,g,x,n,s,f,c,h,u,p,m,v,r,a,function(t){j[t?"unshift":"push"]((()=>{g=t,i(2,g)}))}]}class Ce extends t{constructor(t){super(),e(this,t,De,Te,i,{point:7,color:0,transform:8,constrain:9})}get point(){return this.$$.ctx[7]}set point(t){this.$$set({point:t}),s()}get color(){return this.$$.ctx[0]}set color(t){this.$$set({color:t}),s()}get transform(){return this.$$.ctx[8]}set transform(t){this.$$set({transform:t}),s()}get constrain(){return this.$$.ctx[9]}set constrain(t){this.$$set({constrain:t}),s()}}function Ie(t){let e,i,s,n,o,a=[{cx:i=t[4](t[0][0])},{cy:s=t[3](t[0][1])},{r:n=6},t[6],{style:o=`fill: ${t[1]}; opacity: ${t[2]}; ${t[6].style}`}],l={};for(let t=0;t<a.length;t+=1)l=O(l,a[t]);return{c(){e=r("circle"),S(e,l)},m(t,i){c(t,e,i)},p(t,[n]){S(e,l=M(a,[17&n&&i!==(i=t[4](t[0][0]))&&{cx:i},9&n&&s!==(s=t[3](t[0][1]))&&{cy:s},{r:6},64&n&&t[6],70&n&&o!==(o=`fill: ${t[1]}; opacity: ${t[2]}; ${t[6].style}`)&&{style:o}]))},i:d,o:d,d(t){t&&u(e)}}}function Ke(t,e,i){let s,n;const r=["point","color","opacity"];let o,a=A(e,r),{point:c=U.create()}=e,{color:l="var(--visual-math-fg)"}=e,{opacity:h=1}=e;const u=N();return $(t,u,(t=>i(7,o=t))),t.$$set=t=>{e=O(O({},e),P(t)),i(6,a=A(e,r)),"point"in t&&i(0,c=t.point),"color"in t&&i(1,l=t.color),"opacity"in t&&i(2,h=t.opacity)},t.$$.update=()=>{128&t.$$.dirty&&i(4,s=o.scaleX),128&t.$$.dirty&&i(3,n=o.scaleY)},[c,l,h,n,s,u,a,o]}class Ve extends t{constructor(t){super(),e(this,t,Ke,Ie,i,{point:0,color:1,opacity:2})}get point(){return this.$$.ctx[0]}set point(t){this.$$set({point:t}),s()}get color(){return this.$$.ctx[1]}set color(t){this.$$set({color:t}),s()}get opacity(){return this.$$.ctx[2]}set opacity(t){this.$$set({opacity:t}),s()}}function ze(t){let e,i,s,n,o,l,h;return{c(){e=r("line"),a(e,"x1",i=t[4][0]),a(e,"y1",s=t[4][1]),a(e,"x2",n=t[5][0]),a(e,"y2",o=t[5][1]),a(e,"style",l=`stroke: ${t[0]}`),a(e,"stroke-width",t[2]),a(e,"opacity",t[3]),a(e,"stroke-dasharray",h="dashed"===t[1]?"4,3":void 0)},m(t,i){c(t,e,i)},p(t,[r]){16&r&&i!==(i=t[4][0])&&a(e,"x1",i),16&r&&s!==(s=t[4][1])&&a(e,"y1",s),32&r&&n!==(n=t[5][0])&&a(e,"x2",n),32&r&&o!==(o=t[5][1])&&a(e,"y2",o),1&r&&l!==(l=`stroke: ${t[0]}`)&&a(e,"style",l),4&r&&a(e,"stroke-width",t[2]),8&r&&a(e,"opacity",t[3]),2&r&&h!==(h="dashed"===t[1]?"4,3":void 0)&&a(e,"stroke-dasharray",h)},i:d,o:d,d(t){t&&u(e)}}}const Ye=U.create();function qe(t,e,i){let s,n,{point1:r=U.create()}=e,{point2:o=U.create()}=e,{color:a="var(--visual-math-fg)"}=e,{style:c="solid"}=e,{weight:l=2}=e,{opacity:h=1}=e;const u=N();$(t,u,(t=>i(11,n=t)));let d=U.create(),p=U.create(),f=U.create();return t.$$set=t=>{"point1"in t&&i(7,r=t.point1),"point2"in t&&i(8,o=t.point2),"color"in t&&i(0,a=t.color),"style"in t&&i(1,c=t.style),"weight"in t&&i(2,l=t.weight),"opacity"in t&&i(3,h=t.opacity)},t.$$.update=()=>{2048&t.$$.dirty&&i(10,s=n.pixelMatrix),896&t.$$.dirty&&i(9,d=U.scale(d,U.normalize(d,U.sub(Ye,o,r)),1e5)),1680&t.$$.dirty&&i(4,p=U.transformMat2d(p,U.sub(Ye,r,d),s)),1824&t.$$.dirty&&i(5,f=U.transformMat2d(f,U.add(Ye,o,d),s))},[a,c,l,h,p,f,u,r,o,d,s,n]}class Xe extends t{constructor(t){super(),e(this,t,qe,ze,i,{point1:7,point2:8,color:0,style:1,weight:2,opacity:3})}get point1(){return this.$$.ctx[7]}set point1(t){this.$$set({point1:t}),s()}get point2(){return this.$$.ctx[8]}set point2(t){this.$$set({point2:t}),s()}get color(){return this.$$.ctx[0]}set color(t){this.$$set({color:t}),s()}get style(){return this.$$.ctx[1]}set style(t){this.$$set({style:t}),s()}get weight(){return this.$$.ctx[2]}set weight(t){this.$$set({weight:t}),s()}get opacity(){return this.$$.ctx[3]}set opacity(t){this.$$set({opacity:t}),s()}}function Ue(t){let e,i;return e=new Xe({props:{point1:t[0],point2:t[5],color:t[1],opacity:t[4],style:t[2],weight:t[3]}}),{c(){g(e.$$.fragment)},m(t,s){y(e,t,s),i=!0},p(t,[i]){const s={};1&i&&(s.point1=t[0]),32&i&&(s.point2=t[5]),2&i&&(s.color=t[1]),16&i&&(s.opacity=t[4]),4&i&&(s.style=t[2]),8&i&&(s.weight=t[3]),e.$set(s)},i(t){i||(m(e.$$.fragment,t),i=!0)},o(t){v(e.$$.fragment,t),i=!1},d(t){x(e,t)}}}const He=U.create(),Be=U.create(),Re=U.fromValues(1,0);function Ne(t,e,i){let{point:s=U.create()}=e,{angle:n=0}=e,{color:r="var(--visual-math-fg)"}=e,{style:o="solid"}=e,{weight:a=2}=e,{opacity:c=1}=e,l=U.create();return t.$$set=t=>{"point"in t&&i(0,s=t.point),"angle"in t&&i(6,n=t.angle),"color"in t&&i(1,r=t.color),"style"in t&&i(2,o=t.style),"weight"in t&&i(3,a=t.weight),"opacity"in t&&i(4,c=t.opacity)},t.$$.update=()=>{97&t.$$.dirty&&i(5,l=U.add(l,s,U.rotate(He,Re,Be,n)))},[s,r,o,a,c,l,n]}class Ge extends t{constructor(t){super(),e(this,t,Ne,Ue,i,{point:0,angle:6,color:1,style:2,weight:3,opacity:4})}get point(){return this.$$.ctx[0]}set point(t){this.$$set({point:t}),s()}get angle(){return this.$$.ctx[6]}set angle(t){this.$$set({angle:t}),s()}get color(){return this.$$.ctx[1]}set color(t){this.$$set({color:t}),s()}get style(){return this.$$.ctx[2]}set style(t){this.$$set({style:t}),s()}get weight(){return this.$$.ctx[3]}set weight(t){this.$$set({weight:t}),s()}get opacity(){return this.$$.ctx[4]}set opacity(t){this.$$set({opacity:t}),s()}}function We(t){let e,i;return e=new Ge({props:{point:t[0],angle:t[5],color:t[1],opacity:t[4],style:t[2],weight:t[3]}}),{c(){g(e.$$.fragment)},m(t,s){y(e,t,s),i=!0},p(t,[i]){const s={};1&i&&(s.point=t[0]),32&i&&(s.angle=t[5]),2&i&&(s.color=t[1]),16&i&&(s.opacity=t[4]),4&i&&(s.style=t[2]),8&i&&(s.weight=t[3]),e.$set(s)},i(t){i||(m(e.$$.fragment,t),i=!0)},o(t){v(e.$$.fragment,t),i=!1},d(t){x(e,t)}}}function Fe(t,e,i){let{point:s=U.create()}=e,{slope:n=0}=e,{color:r="var(--visual-math-fg)"}=e,{style:o="solid"}=e,{weight:a=2}=e,{opacity:c=1}=e,l=Math.atan(n);return t.$$set=t=>{"point"in t&&i(0,s=t.point),"slope"in t&&i(6,n=t.slope),"color"in t&&i(1,r=t.color),"style"in t&&i(2,o=t.style),"weight"in t&&i(3,a=t.weight),"opacity"in t&&i(4,c=t.opacity)},t.$$.update=()=>{64&t.$$.dirty&&i(5,l=Math.atan(n))},[s,r,o,a,c,l,n]}class Je extends t{constructor(t){super(),e(this,t,Fe,We,i,{point:0,slope:6,color:1,style:2,weight:3,opacity:4})}get point(){return this.$$.ctx[0]}set point(t){this.$$set({point:t}),s()}get slope(){return this.$$.ctx[6]}set slope(t){this.$$set({slope:t}),s()}get color(){return this.$$.ctx[1]}set color(t){this.$$set({color:t}),s()}get style(){return this.$$.ctx[2]}set style(t){this.$$set({style:t}),s()}get weight(){return this.$$.ctx[3]}set weight(t){this.$$set({weight:t}),s()}get opacity(){return this.$$.ctx[4]}set opacity(t){this.$$set({opacity:t}),s()}}function Qe(t){n(t,"svelte-5trppw",".visual-math.svelte-5trppw{display:block;background:var(--visual-math-bg);overflow:hidden;user-select:none;font-family:sans-serif;font-variant-numeric:tabular-nums;--visual-math-bg:#f1f1f1;--visual-math-fg:black;--visual-math-origin-color:var(--visual-math-fg);--visual-math-line-color:#555;--grid-line-subdivision-color:#222;--visual-math-red:#f10000;--visual-math-orange:#f18100;--visual-math-yellow:#f1f100;--visual-math-green:#00f181;--visual-math-blue:#0000f1;--visual-math-indigo:#8100f1;--visual-math-violet:#8100f1;--visual-math-pink:#f18181}")}function Ze(t){let e,i,s,n,o,h,d;const p=t[38].default,$=T(p,t,t[37],null);return{c(){e=L("div"),i=r("svg"),$&&$.c(),a(i,"width",t[2]),a(i,"height",t[3]),a(i,"viewBox",s=`${-t[5](0)} ${-t[4](0)} ${t[2]} ${t[3]}`),a(i,"preserveAspectRatio","xMidYMin"),a(i,"style",n=`width: ${t[0]}; touch-action: ${t[1]?"none":"auto"};`),a(e,"class","visual-math svelte-5trppw"),a(e,"style",o=`width: ${t[8]}; height: ${t[7]}`),D((()=>t[40].call(e)))},m(s,n){c(s,e,n),l(e,i),$&&$.m(i,null),t[39](e),h=C(e,t[40].bind(e)),d=!0},p(t,r){$&&$.p&&(!d||64&r[1])&&I($,p,t,t[37],d?V(p,t[37],r,null):K(t[37]),null),(!d||4&r[0])&&a(i,"width",t[2]),(!d||8&r[0])&&a(i,"height",t[3]),(!d||60&r[0]&&s!==(s=`${-t[5](0)} ${-t[4](0)} ${t[2]} ${t[3]}`))&&a(i,"viewBox",s),(!d||3&r[0]&&n!==(n=`width: ${t[0]}; touch-action: ${t[1]?"none":"auto"};`))&&a(i,"style",n),(!d||384&r[0]&&o!==(o=`width: ${t[8]}; height: ${t[7]}`))&&a(e,"style",o)},i(t){d||(m($,t),d=!0)},o(t){v($,t),d=!1},d(i){i&&u(e),$&&$.d(i),t[39](null),h()}}}const ti=U.create();function ei(t,e,i){let s,n,r,o,a,c,l,h,u,d,p,$,f,g,y,m,v,x,b,{$$slots:w={},$$scope:k}=e,{width:O=500}=e,{height:S=500}=e,{pan:_=!0}=e,{zoom:M=!0}=e,{xAxisExtent:A=U.fromValues(-5.5,5.5)}=e,{yAxisExtent:P=U.fromValues(-5.5,5.5)}=e,E="number"==typeof O?O:500,T="number"==typeof S?S:500,L=Math.min(A[1]-A[0],P[1]-P[0]),D=U.fromValues(0,0),C=U.fromValues(A[0],P[0]),I=U.fromValues(A[1],P[1]),K=U.create(),V=H.create(),Y=H.create(),N=[],W=[],J=U.create(),Z=U.create(),tt=B({xPanes:N,yPanes:W,xPaneRange:J,yPaneRange:Z});q(Q,tt);let et=B({min:C,max:I,width:E,height:T});!function(t){q(G,t)}(et);let it=B({zoomAmount:L,scaleX:a,scaleY:c,span:K,pixelMatrix:V,inversePixelMatrix:Y,cssScale:u});!function(t){q(R,t)}(it);let st,nt=B({mapX:r,mapY:o});return function(t){q(F,t)}(nt),X((()=>{const t=new Ee(st,x),e=new je(st,b);return()=>{t.destroy(),e.destroy()}})),t.$$set=t=>{"width"in t&&i(0,O=t.width),"height"in t&&i(11,S=t.height),"pan"in t&&i(1,_=t.pan),"zoom"in t&&i(12,M=t.zoom),"xAxisExtent"in t&&i(9,A=t.xAxisExtent),"yAxisExtent"in t&&i(10,P=t.yAxisExtent),"$$scope"in t&&i(37,k=t.$$scope)},t.$$.update=()=>{if(1&t.$$.dirty[0]&&i(8,s="auto"===O?"100%":`${O}px`),2048&t.$$.dirty[0]&&i(7,n="auto"===S?"100%":`${S}px`),13824&t.$$.dirty[0]&&(b=t=>{if(!M||t.last)return;const e=function(t){if("number"==typeof t.detail&&0!==t.detail){if(t.detail>0)return-1;if(t.detail<0)return 1}else if("number"==typeof t.wheelDelta){if(t.wheelDelta<0)return-1;if(t.wheelDelta>0)return 1}}(t.event);e&&(L>3||e<0)&&(i(9,A=U.set(A,A[0]+e,A[1]-e)),i(10,P=U.set(P,P[0]+e,P[1]-e)),i(13,L=Math.min(A[1]-A[0],P[1]-P[0])))}),8204&t.$$.dirty[0]){const t=.5*L,e=.5*(L*(E/T));i(9,A[0]=-e,A),i(9,A[1]=e,A),i(10,P[0]=-t,P),i(10,P[1]=t,P)}1550&t.$$.dirty[0]&&(x=t=>{_&&(i(14,D[0]=-t.offset[0]/E*(A[1]-A[0]),D),i(14,D[1]=-t.offset[1]/T*(P[1]-P[0]),D))}),50688&t.$$.dirty[0]&&i(15,C=U.add(C,D,U.set(ti,A[0],P[0]))),83456&t.$$.dirty[0]&&i(16,I=U.add(I,D,U.set(ti,A[1],P[1]))),98308&t.$$.dirty[0]&&i(5,r=t=>(t-C[0])/(I[0]-C[0])*E),98312&t.$$.dirty[0]&&i(4,o=t=>(t-C[1])/(I[1]-C[1])*T),229376&t.$$.dirty[0]&&i(17,K=U.sub(K,I,C)),131076&t.$$.dirty[0]&&i(26,a=t=>t/K[0]*E),131080&t.$$.dirty[0]&&i(25,c=t=>-t/K[1]*T),98304&t.$$.dirty[0]&&i(34,d=I[0]-C[0]),4&t.$$.dirty[0]|8&t.$$.dirty[1]&&i(36,l=t=>t/E*d),98304&t.$$.dirty[0]&&i(30,g=I[1]-C[1]),1073741832&t.$$.dirty[0]&&i(35,h=t=>-t/T*g),100925440&t.$$.dirty[0]&&i(18,V=H.fromScaling(V,U.set(ti,a(1),c(1)))),524288&t.$$.dirty[0]|48&t.$$.dirty[1]&&i(19,Y=H.fromScaling(Y,U.set(ti,l(1),h(1)))),100663296&t.$$.dirty[0]&&i(24,u=`scale(${a(1)} ${c(1)})`),8&t.$$.dirty[1]&&i(33,p=Math.pow(2,Math.round(Math.log10(d)/Math.log10(2)))),32768&t.$$.dirty[0]|4&t.$$.dirty[1]&&i(32,$=Math.floor(C[0]/p)*p),65536&t.$$.dirty[0]|4&t.$$.dirty[1]&&i(31,f=Math.ceil(I[0]/p)*p),7&t.$$.dirty[1]&&i(20,N=z($,f,p).iter().map((t=>U.fromValues(t,t+p))).toArray()),4194304&t.$$.dirty[0]|3&t.$$.dirty[1]&&i(22,J=U.set(J,$,f)),1073741824&t.$$.dirty[0]&&i(29,y=Math.pow(2,Math.round(Math.log10(g)/Math.log10(2)))),536903680&t.$$.dirty[0]&&i(28,m=Math.floor(C[0]/y)*y),536936448&t.$$.dirty[0]&&i(27,v=Math.ceil(I[0]/y)*y),939524096&t.$$.dirty[0]&&i(21,W=z(m,v,y).iter().map((t=>U.fromValues(t,t+y))).toArray()),411041792&t.$$.dirty[0]&&i(23,Z=U.set(Z,m,v)),15728640&t.$$.dirty[0]&&tt.set({xPanes:N,yPanes:W,xPaneRange:J,yPaneRange:Z}),98316&t.$$.dirty[0]&&et.set({min:C,max:I,width:E,height:T}),118366208&t.$$.dirty[0]&&it.set({zoomAmount:L,scaleX:a,scaleY:c,span:K,pixelMatrix:V,inversePixelMatrix:Y,cssScale:u}),48&t.$$.dirty[0]&&nt.set({mapX:r,mapY:o})},[O,_,E,T,o,r,st,n,s,A,P,S,M,L,D,C,I,K,V,Y,N,W,J,Z,u,c,a,v,m,y,g,f,$,p,d,h,l,k,w,function(t){j[t?"unshift":"push"]((()=>{st=t,i(6,st)}))},function(){E=this.offsetWidth,T=this.offsetHeight,i(2,E),i(3,T)}]}class ii extends t{constructor(t){super(),e(this,t,ei,Ze,i,{width:0,height:11,pan:1,zoom:12,xAxisExtent:9,yAxisExtent:10},Qe,[-1,-1])}get width(){return this.$$.ctx[0]}set width(t){this.$$set({width:t}),s()}get height(){return this.$$.ctx[11]}set height(t){this.$$set({height:t}),s()}get pan(){return this.$$.ctx[1]}set pan(t){this.$$set({pan:t}),s()}get zoom(){return this.$$.ctx[12]}set zoom(t){this.$$set({zoom:t}),s()}get xAxisExtent(){return this.$$.ctx[9]}set xAxisExtent(t){this.$$set({xAxisExtent:t}),s()}get yAxisExtent(){return this.$$.ctx[10]}set yAxisExtent(t){this.$$set({yAxisExtent:t}),s()}}export{jt as CartesianCoordinates,Vt as Circle,Ct as Ellipse,bt as GridPattern,Ce as MovablePoint,Ve as Point,Ge as PointAngle,Je as PointSlope,Xe as ThroughPoints,ii as VisualMath,ot as XLabels,dt as YLabels,W as getCoordinateContext,J as getMapContext,Z as getPanesContext,N as getScaleContext,tt as snappedRange};
//# sourceMappingURL=index.js.map
